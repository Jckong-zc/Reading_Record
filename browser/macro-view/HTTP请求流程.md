# HTTP 请求流程

HTTP 协议建立在 TCP 连接基础之上

HTTP 是一种允许浏览器向服务器获取资源的协议，是 Web 的基础，通常由浏览器发起请求，用来获取不同类型的文件（HTML、CSS、JS、图片等静态资源）

HTTP 是浏览器使用最广的协议

## TCP 和 HTTP 的关系

浏览器使用 HTTP 协议作为应用层协议，封装请求的文本信息

使用 TCP/IP 协议作传输层协议将它发布到网络上

在 HTTP 开始工作前，浏览器需要通过 TCP 与服务器建立连接

HTTP 的内容是通过 TCP 的传输数据阶段来实现的

![TCP 和 HTTP 的关系](./TCP&HTTP.png)

- HTTP 网络请求的第一步？

  通过 TCP 三次握手和服务器建立 TCP 连接

- 建立连接需要哪些信息？

  建立连接需要 IP 地址和端口号

  - IP 地址：通过 DNS 域名系统进行域名 -> IP 地址的映射，获取域名对应的 IP
  - 端口号：如果 URL 没有指定端口，使用 HTTP 协议默认端口 80

##： 浏览器端发起 HTTP 请求流程

### 1. 构建请求

浏览器构建**请求行**信息，构建好后，浏览器准备发起网络请求

请求行举例：

`GET /index.html HTTP1.1`

请求行的构成：请求方法 + URL字段 + HTTP 版本

### 2. 查找缓存

发起真正网络请求前浏览器会现在浏览器缓存中查询是否有要请求的文件

浏览器缓存时一种在本地保存资源副本，以供下次请求时直接使用的技术

如果命中缓存，浏览器会拦截请求，返回资源副本，结束请求，无需下载

- 缓存的好处
  1. 缓解服务器压力，提升性能（减少资源获取时间）
  2. 资源快速加载

### 3. 准备 IP 地址和端口

- IP 地址：通过 **DNS 域名系统**进行域名 -> IP 地址的映射（**有 DNS 缓存，如果命中缓存会直接使用缓存的解析结果，可以减少一次网络请求**），获取域名对应的 IP
- 端口号：如果 URL 没有指定端口，使用 **HTTP 协议默认端口 80**

### 4. 等待 TCP 队列

